Think of Order as a snapshot of the cart at checkout time. 

An order is:
A permanent record of what the user bought, at what price, and when.

| Cart                   | Order           |
| ---------------------- | --------------- |
| Temporary              | Permanent       |
| Editable               | Not editable    |
| Uses live product data | Stores snapshot |
| Can be cleared         | Never deleted   |


So orders store:
product name
price at purchase time
quantity


User clicks "Place Order"
â†“
Backend verifies cart
â†“
Backend creates order from cart
â†“
Backend clears cart
â†“
Order is stored forever


Step-by-step Order Creation Logic
ðŸ”¹ Step 1: Authenticate user

Use auth middleware
Get req.user.id

ðŸ”¹ Step 2: Fetch user cart

Find cart by userId
If no cart or empty â†’ error

ðŸ”¹ Step 3: Prepare order items (SNAPSHOT)

For each cart item:
Copy productId
Copy product name
Copy product price
Copy quantity
This is order data, not cart data.

ðŸ”¹ Step 4: Calculate order totals

From snapshot:
totalAmount
totalItems

Do NOT calculate later.

ðŸ”¹ Step 5: Create Order document

Order contains:
user
items (snapshot)
totals
status
timestamps

ðŸ”¹ Step 6: Clear cart

After order is successfully created:
cart.items = []
save cart

ðŸ”¹ Step 7: Return order confirmation

Send:
orderId
totals
status


| Method | Route                 | Purpose               |
| ------ | --------------------- | --------------------- |
| POST   | /api/order            | Place order           |
| GET    | /api/order            | Get user orders       |
| GET    | /api/order/:id        | Get order details     |
| PUT    | /api/order/:id/status | Update status (admin) |

PUT /api/admin/order/:id/status
GET /api/admin/orders

Order status work with cod - order lifecycle -:

PENDING     â†’ order placed, cash not collected yet
SHIPPED     â†’ order dispatched
DELIVERED  â†’ cash collected successfully
CANCELLED  â†’ order cancelled





PUT /api/admin/order/:id/status
This API exists for order lifecycle management

only admins can: 
ship orders 
mark them delivered 
cancel them


allowed transitions in PUT /api/admin/order/:id/status
Pending   â†’ Shipped
Shipped   â†’ Delivered
Pending   â†’ Cancelled
